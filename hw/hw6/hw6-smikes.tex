\documentclass[12pt,letterpaper,fleqn]{hmcpset}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{parskip}

\input{macros.tex}

% info for header block in upper right hand corner
\name{Sam Mikes}
\class{Math189R SU20.1}
\assignment{Homework 6}
\duedate{Tuesday June 30, 2020}

\begin{document}

\begin{problem}[1]
\textbf{(Murphy 11.2 - EM for Mixtures of Gaussians)} Show that the M step for ML
estimation of a mixture of Gaussians is given by
\begin{align*}
    \mub_k &= \frac{\sum_i r_{ik}\xx_i}{r_k}\\
    \Sigmab_k &= \frac{1}{r_k}\sum_i r_{ik}(\xx_i - \mub_k)(\xx_i - \mub_k)^\T = \frac{1}{r_k}\sum_i r_{ik}\xx_i\xx_i^\T - r_k\mub_k\mub_k^\T.
\end{align*}
\end{problem}
\begin{solution}

\begin{align*}
  \Sigmab_k &= \frac{1}{r_k}\sum_i r_{ik}(\xx_i - \frac{\sum_j r_{jk}\xx_j}{r_k}) (\xx_i - \frac{\sum_j r_{jk}\xx_j}{r_k})^\T \\
  &= \frac{1}{r_k}\sum_{ij} r_{ik}(\xx_i - \frac{r_{jk}\xx_j}{r_k}) (\xx_i - \frac{r_{jk}\xx_j}{r_k})^\T \\
  &= \frac{1}{r_k}\sum_{ij} r_{ik} ( \xx_i\xx_i^\T - (\xx_i\xx_j^\T + \xx_j\xx_i^\T) \frac{r_{jk}}{r_k} + \frac{r_{jk}^2\xx_j\xx_j^\T}{r_k^2} ) \\
  &= \frac{1}{r_k}\sum_{i} r_{ik} \xx_i\xx_i^\T - \sum_{ij} \frac {r_{jk}}{r_k^2} (\xx_i\xx_j^\T + \xx_j\xx_i^\T) + r_k \sum_j \frac{r_{jk}^2\xx_j\xx_j^\T}{r_k^2} \\
  &= \frac{1}{r_k}\sum_{i} r_{ik} \xx_i\xx_i^\T + r_k \sum_j \frac{r_{jk}\xx_j}{r_k} \frac{r_{jk} \xx_j^\T}{r_k}  - \sum_{ij} \frac {r_{jk}^2}{r_k^2} (\xx_i\xx_j^\T + \xx_j\xx_i^\T) \\
  &= \frac{1}{r_k}\sum_{i} r_{ik} \xx_i\xx_i^\T + r_k \mub_k \mub_k^\T
\end{align*}  

Where the term in $\xx_i\xx_j^\T$ vanishes because at a maximum, the $\xx_i$ are mutually orthogonal.
\end{solution}

\vfill
\newpage



\begin{problem}[2]
\textbf{(SVD Image Compression)}
In this problem, we will use the image of a scary clown online to perform image compression.  In the starter code, we have already load the image into a matrix/array for you. However, you might need internet connection to access the image and therefore successfully run the starter code. The code requires Python library Pillow in order to run.
\newline
\newline 
Plot the progression of the 100 largest singular values for the original image
and a randomly shuffled version of the same image (all on the same plot). In a single figure plot
a grid of four images: the original image, and a rank $k$ truncated SVD approximation of the original
image for $k\in\{2,10,20\}$.

\end{problem}
\begin{solution}
\vfill
\end{solution}
\newpage

\end{document}
